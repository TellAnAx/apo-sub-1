Ca_in_CaSO4 = solubility_data$Ks0[which(solubility_data$chemFormula == "CaSO4",)] / species_SO4_molL,
Ca_found_greater_CaSO4 = Ca > Ca_in_CaSO4,
CaSO4_diff = Ca - Ca_in_CaSO4,
CaSO4_prop = Ca / Ca_in_CaSO4,
# MgCO3
Mg_in_MgCO3 = solubility_data$Ks0[which(solubility_data$chemFormula == "MgCO3",)] / species_CO3_molL,
Mg_found_greater_MgCO3 = Mg > Mg_in_MgCO3,
MgCO3_diff = Mg - Mg_in_MgCO3,
MgCO3_prop = Mg / Mg_in_MgCO3,
# Mg(OH)2
Mg_in_MgOH2 = solubility_data$Ks0[which(solubility_data$chemFormula == "Mg(OH)2",)] / species_OH_molL^2,
Mg_found_greater_MgOH2 = Mg > Mg_in_MgOH2,
MgOH2_diff = Mg - Mg_in_MgOH2,
MgOH2_prop = Mg / Mg_in_MgOH2,
# Mg3PO42
Mg_in_Mg3PO42 = (solubility_data$Ks0[which(solubility_data$chemFormula == "Mg3(PO4)2",)] / species_PO4_molL^2)^(1/3),
Mg_found_greater_Mg3PO42 = Mg > Mg_in_Mg3PO42,
Mg3PO42_diff = Mg - Mg_in_Mg3PO42,
Mg3PO42_prop = Mg / Mg_in_Mg3PO42,
# FePO4
Fe_in_FePO4 = solubility_data$Ks0[which(solubility_data$chemFormula == "FePO4 x 2 H2O",)] / species_PO4_molL,
Fe_found_greater_FePO4 = Fe > Fe_in_FePO4,
FePO4_diff = Fe - Fe_in_FePO4,
FePO4_prop = Fe / Fe_in_FePO4,
# MnCO3
Mn_in_MnCO3 = solubility_data$Ks0[which(solubility_data$chemFormula == "MnCO3",)] / species_CO3_molL,
Mn_found_greater_MnCO3 = Mn > Mn_in_MnCO3,
MnCO3_diff = Mn - Mn_in_MnCO3,
MnCO3_prop = Mn / Mn_in_MnCO3,
# Cu3PO42
Cu_in_Cu3PO42 = (solubility_data$Ks0[which(solubility_data$chemFormula == "Cu3(PO4)2",)] / species_PO4_molL^2)^(1/3),
Cu_found_greater_Cu3PO42 = Cu > Cu_in_Cu3PO42,
Cu3PO42_diff = Cu - Cu_in_Cu3PO42,
Cu3PO42_prop = Cu / Cu_in_Cu3PO42,
# ZnCO3
Zn_in_ZnCO3 = solubility_data$Ks0[which(solubility_data$chemFormula == "ZnCO3",)] / species_CO3_molL,
Zn_found_greater_ZnCO3 = Zn > Zn_in_ZnCO3,
ZnCO3_diff = Zn - Zn_in_ZnCO3,
ZnCO3_prop = Zn / Zn_in_ZnCO3,
# Zn(OH)2
Zn_in_ZnOH2 = solubility_data$Ks0[which(solubility_data$chemFormula == "Zn(OH)2",)] / species_OH_molL^2,
Zn_found_greater_ZnOH2 = Zn > Zn_in_ZnOH2,
ZnOH2_diff = Zn - Zn_in_ZnOH2,
ZnOH2_prop = Zn / Zn_in_ZnOH2,
# NiCO3
Ni_in_NiCO3 = solubility_data$Ks0[which(solubility_data$chemFormula == "NiCO3",)] / species_CO3_molL,
Ni_found_greater_NiCO3 = Ni > Ni_in_NiCO3,
NiCO3_diff = Ni - Ni_in_NiCO3,
NiCO3_prop = Ni / Ni_in_NiCO3,
# Ni(OH)2
Ni_in_NiOH2 = solubility_data$Ks0[which(solubility_data$chemFormula == "Ni(OH)2",)] / species_OH_molL^2,
Ni_found_greater_NiOH2 = Ni > Ni_in_NiOH2,
NiOH2_diff = Ni - Ni_in_NiOH2,
NiOH2_prop = Ni / Ni_in_NiOH2,
# Ni3PO42
Ni_in_Ni3PO42 = (solubility_data$Ks0[which(solubility_data$chemFormula == "Ni3(PO4)2",)] / species_PO4_molL^2)^(1/3),
Ni_found_greater_Ni3PO42 = Ni > Ni_in_Ni3PO42,
Ni3PO42_diff = Ni - Ni_in_Ni3PO42,
Ni3PO42_prop = Ni / Ni_in_Ni3PO42
) %>%
print()
procdata %>%
select(Ca_in_CaCO3:Ni_in_Ni3PO42) %>%
print()
#procdata %>%
plotdata <- procdata %>%
select(ends_with('_prop')) %>%
pivot_longer(
cols = everything(),
names_to = 'substance',
values_to = 'proportion'
) %>%
mutate(
substance = sub('_prop', '', substance)
) %>%
filter(
proportion != Inf
) %>%
print()
plotdata %>%
#filter(proportion < 2) %>%
mutate(
substance = as.factor(substance),
treshold_label = if_else(proportion > 1, true = '2', false = '1')
) %>%
ggplot(aes(
x = substance,
y = proportion,
fill = treshold_label
)) +
geom_boxplot() +
geom_hline(yintercept = 1, linetype = 'dashed', color = 'red', alpha = 0.75) +
scale_y_log10() +
#facet_wrap(facets = vars(substance), scales = 'free') +
labs(
x = 'Empirical solubility compared with solubility of salt',
y = 'log(proportion)'
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45),
legend.position = 'none'
)
knitr::opts_chunk$set(echo = TRUE)
time <- 1:10
hrt <- 20
c_in <- 1
c_out <- seq(0.1,1,0.1)
time <- 1:10
hrt <- 20
c_in <- 1
c_out <- seq(0.1,1,0.1)
plot((1-exp(-(c_out/c_in)))~(c_out/c_in))
plot((1-exp(-(time/hrt)))~(c_out/c_in))
hrt <- 20
c_in <- 1
time <- 1:10/hrt
c_out <- seq(0.1,1,0.1)/c_in
plot((1-exp(-(time/hrt)))~(c_out/c_in))
hrt <- 20
c_in <- 1
time <- 1:10/hrt
c_out <- seq(0.1,1,0.1)/c_in
plot((1-exp(-time))~(c_out/c_in))
hrt <- 20
c_in <- 1
time <- 1:10/hrt
c_out <- seq(0.1,1,0.1)/c_in
plot((1-exp(-time))~(c_out))
hrt <- 1
c_in <- 1
time <- 1:10/hrt
c_out <- seq(0.1,1,0.1)/c_in
plot((1-exp(-time))~(c_out))
hrt <- 20
c_in <- 1
time <- 1:1000/hrt
c_out <- seq(0.1,0.1*length(time),0.1)/c_in
plot((1-exp(-time))~(c_out))
hrt <- 100/5
c_in <- 1
time <- 1:1000/hrt
c_out <- seq(0.1,0.1*length(time),0.1)/c_in
plot((1-exp(-time))~(c_out))
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- seq(0.1,0.1*length(time),0.1)/c_in
plot((1-exp(-time))~(c_out))
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- seq(0.1,0.1*length(time),0.1)/c_in
plot((1-exp(-time))~(c_out))
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- seq(0.1,0.1*length(time),0.1)/c_in
plot((1-exp(-time))~(c_out))
print(paste("Hydraulic retention time = ", hrt))
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- seq(0.1,0.1*length(time),0.1)/c_in
plot((1-exp(-time))~(c_out))
print(paste("Hydraulic retention time =", hrt, "//test"))
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- seq(0.1,0.1*length(time),0.1)/c_in
plot((1-exp(-time))~(c_out))
print(paste("Hydraulic retention time =", hrt, "\\test"))
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- seq(0.1,0.1*length(time),0.1)/c_in
plot((1-exp(-time))~(c_out))
print(paste("Hydraulic retention time =", hrt, "\n test"))
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- seq(0.1,0.1*length(time),0.1)/c_in
plot((1-exp(-time))~(c_out))
print(paste("Hydraulic retention time =", hrt, "/n test"))
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- seq(0.1,0.1*length(time),0.1)/c_in
plot((1-exp(-time))~(c_out))
print(paste("Hydraulic retention time =", hrt, "\n\n test"))
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- seq(0.1,0.1*length(time),0.1)/c_in
plot((1-exp(-time))~(c_out))
print(paste("Hydraulic retention time =", hrt, \n, "test"))
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- seq(0.1,0.1*length(time),0.1)/c_in
plot((1-exp(-time))~(c_out))
print(cat("Hydraulic retention time =", hrt, "\n test"))
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- seq(0.1,0.1*length(time),0.1)/c_in
plot((1-exp(-time))~(c_out))
print(paste(cat("Hydraulic retention time =", hrt, "\n test")))
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- seq(0.1,0.1*length(time),0.1)/c_in
plot((1-exp(-time))~(c_out))
print(cat("Hydraulic retention time =", hrt, "\n test might work"))
?cat
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- seq(0.1,0.1*length(time),0.1)/c_in
plot((1-exp(-time))~(c_out))
print(cat("Hydraulic retention time =", hrt, "\n", "test might work"))
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- seq(0.1,0.1*length(time),0.1)/c_in
plot((1-exp(-time))~(c_out))
cat("Hydraulic retention time =", hrt, "\n test might work")
init = 0.3
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot((1-exp(-time))~(c_out))
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init)
par(mfrow=c(2,1))
init = 0.3
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot((1-exp(-time))~(c_out))
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init)
par(mfrow=c(2,1))
init = 0.3
hrt <- 100/1
c_in <- 1
time <- 1:1000/hrt
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot((1-exp(-time))~(c_out))
plot((1-exp(-time))~(c_out2))
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init)
par(mfrow=c(2,1))
init = 0.3
hrt <- 100/10
c_in <- 1
time <- 1:1000/hrt
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot((1-exp(-time))~(c_out))
plot((1-exp(-time))~(c_out2))
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init)
par(mfrow=c(2,1))
init = 0.3
hrt <- 100/10
c_in <- 1
time <- 1:100/hrt
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot((1-exp(-time))~(c_out))
plot((1-exp(-time))~(c_out2))
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init)
par(mfrow=c(2,1))
init = 0.3
hrt <- 100/10
c_in <- 1
time <- 1:50/hrt
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot((1-exp(-time))~(c_out))
plot((1-exp(-time))~(c_out2))
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init)
par(mfrow=c(2,1))
init = 0.7
hrt <- 100/10
c_in <- 1
time <- 1:50/hrt
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot((1-exp(-time))~(c_out))
plot((1-exp(-time))~(c_out2))
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init)
par(mfrow=c(2,1))
init = 0.7
hrt <- 100/10
c_in <- 1
time <- 1:50/hrt
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot((c_out)~(1-exp(-time)))
plot((c_out2)~(1-exp(-time)))
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init)
par(mfrow=c(2,1))
init = 0.7
hrt <- 100/10
c_in <- 1
time <- 1:50/hrt
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot((1-exp(-time))~(c_out))
plot((1-exp(-time))~(c_out2))
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init)
par(mfrow=c(2,1))
init = 0.7
hrt <- 100/20
c_in <- 1
time <- 1:50/hrt
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot((1-exp(-time))~(c_out))
plot((1-exp(-time))~(c_out2))
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init)
ggplot(aes(x=c_out, y = (1-exp(-time)))) +
stat_function(fun = function(x) c_out)
library(ggplot2)
ggplot(aes(x=c_out, y = (1-exp(-time)))) +
stat_function(fun = function(x) c_out)
c_out <- data.frame(c_out = (seq(0.1,0.1*length(time),0.1))/c_in)
ggplot(c_out, aes(x=c_out, y = (1-exp(-time)))) +
stat_function(fun = function(x) c_out)
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
time <- 1:50/hrt
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
data <- data.frame(time = time, c_out = c_out)
library(ggplot2)
ggplot(data, aes(x=c_out, y = (1-exp(-time)))) +
stat_function(fun = function(x) c_out)
?function
()
mean()
time <- 1:50/hrt
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot((1-exp(-time))~(c_out))
points((1-exp(-time))~(c_out2))
points((1-exp(-time))~(c_out2), col = 'red')
par(mfrow=c(2,1))
init = 0.7
hrt <- 100/20
c_in <- 1
time <- 1:50/hrt
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot((1-exp(-time))~(c_out))
points((1-exp(-time))~(c_out2), col = 'red')
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init)
par(mfrow=c(1,1))
init = 0.7
hrt <- 100/20
c_in <- 1
time <- 1:50/hrt
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot((1-exp(-time))~(c_out))
points((1-exp(-time))~(c_out2), col = 'red')
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init)
init = 0.7
hrt <- 100/20
c_in <- 1
time <- 1:50/hrt
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot(c_out~(1-exp(-time))
points(c_out~(1-exp(-time), col = 'red')
init = 0.7
hrt <- 100/20
c_in <- 1
time <- 1:50/hrt
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot(c_out~(1-exp(-time)))
points(c_out2~(1-exp(-time), col = 'red')
init = 0.7
hrt <- 100/20
c_in <- 1
time <- 1:50/hrt
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot(c_out~(1-exp(-time)))
points(c_out2~(1-exp(-time)), col = 'red')
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init
)
exp(-time)
exp(time)
init = 0.7
hrt <- 100/20
c_in <- 1
time <- hrt/1:50
c_out <- (seq(0.1,0.1*length(time),0.1))/c_in
c_out2 <- (seq(0.1,0.1*length(time),0.1) + init)/c_in
plot(c_out~(1-exp(-time)))
points(c_out2~(1-exp(-time)), col = 'red')
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init
)
init = 0.7
hrt <- 100/20
c_in <- 1
time <- 1:50
c_out_in <- 1-exp(-(time/hrt))
plot(c_out_in~time)
init = 0.7
hrt <- 100/20
c_in <- 1
time <- 1:50
c_out_in <- 1-exp(-(time/hrt))
c_out <- c_in*(1-exp(-(time/hrt)))
c_out2 <- (c_in+init)*(1-exp(-(time/hrt)))
plot(c_out_in~time)
plot(c_out~time)
points(c_out2~time, col = 'red')
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init
)
init = 0.7
hrt <- 100/20
c_in <- 1
time <- 1:50
c_out_in <- 1-exp(-(time/hrt))
c_out <- c_in*(1-exp(-(time/hrt)))
c_out2 <- (c_in+init)*(1-exp(-(time/hrt)))
plot(c_out_in~time)
plot(c_out~time, lmax = c(length(time), 5))
points(c_out2~time, col = 'red')
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init
)
init = 0.7
hrt <- 100/20
c_in <- 1
time <- 1:50
c_out_in <- 1-exp(-(time/hrt))
c_out <- c_in*(1-exp(-(time/hrt)))
c_out2 <- (c_in+init)*(1-exp(-(time/hrt)))
plot(c_out_in~time)
plot(c_out~time, ylim = c(0,5))
points(c_out2~time, col = 'red')
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init
)
init = 0.7
hrt <- 100/20
c_in <- 1
time <- 1:50
c_out_in <- 1-exp(-(time/hrt))
c_out <- c_in*(1-exp(-(time/hrt)))
c_out2 <- (c_in+init)*(1-exp(-(time/hrt)))
plot(c_out_in~time)
plot(c_out~time, ylim = c(0,5))
points(c_out2~time, col = 'red')
abline(h = 1.7)
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init
)
init = 3.7
hrt <- 100/20
c_in <- 1
time <- 1:50
c_out_in <- 1-exp(-(time/hrt))
c_out <- c_in*(1-exp(-(time/hrt)))
c_out2 <- (c_in+init)*(1-exp(-(time/hrt)))
plot(c_out_in~time)
plot(c_out~time, ylim = c(0,5))
points(c_out2~time, col = 'red')
abline(h = 1+init)
cat(
"Hydraulic retention time =", hrt,
"\n Initial concentration =", init
)
