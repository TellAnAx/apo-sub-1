"0","procdata <- targetConc %>%"
"0","  "
"0","  select(c(nutrient, mol_per_L)) %>% "
"0","  "
"0","      group_by(nutrient) %>% # Workaround pivot_wider()"
"0","      mutate(row = row_number()) %>% # Workaround pivot_wider()"
"0","  "
"0","  pivot_wider(names_from = nutrient, values_from = mol_per_L) %>% "
"0","  "
"0","      select(-row) %>%  # Workaround pivot_wider()"
"0",""
"0","  "
"0","  # Calculate species"
"0","  mutate("
"0","    species_PO4_molL = calc_PO4(c_tot = P, pH = pH, form_P = 'po4-p', unit = 'mol'),"
"0","    "
"0","    species_OH_molL = calc_OH(pH = pH),"
"0","    "
"0","    species_CO3_molL = calc_CO3(pH = pH, pCO2 = pCO2_atm),"
"0","    "
"0","    species_SO4_molL = calc_SO4(c_tot = S, pH = pH, form_S = 'SO4-S', unit = 'mol')"
"0","  ) %>% "
"0","  "
"0","  print()"
