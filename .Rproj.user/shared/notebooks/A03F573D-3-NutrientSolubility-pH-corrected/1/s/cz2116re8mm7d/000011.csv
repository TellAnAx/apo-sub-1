"0","procdata <- empirical_data %>% "
"0","  "
"0","  # Rename columns"
"0","  rename("
"0","    'NH4-N' = 'N.NH4_mgL', "
"0","    'NO2-N' = 'N.NO2_mgL', "
"0","    'NO3-N' = 'N.NO3_mgL', "
"0","    'PO4-P' = 'P.PO4_mgL', "
"0","    'K' = 'K_mgL', "
"0","    'Ca' = 'Ca_mgL', "
"0","    'Mg' = 'Mg_mgL', "
"0","    'SO4-S' = 'S.SO4_mgL', "
"0","    'B' = 'B_mgL', "
"0","    'Fe' = 'Fe_mgL', "
"0","    'Mn' = 'Mn_mgL', "
"0","    'Cu' = 'Cu_mgL', "
"0","    'Zn' = 'Zn_mgL', "
"0","    'Na' = 'Na_mgL', "
"0","    'Mo' = 'Mo_mgL', "
"0","    'Ni' = 'Ni_mgL'"
"0","    ) %>% "
"0",""
"0","  select(-ends_with(c('const', 'belowLimit'))) %>% "
"0",""
"0","  # Replace NAs by 0"
"0","  mutate_at(vars(`NH4-N`, `NO2-N`, `NO3-N`), tidyr::replace_na, 0) %>%"
"0","  "
"0","  mutate("
"0","    # Calculate Total Inorganic Nitrogen by summing NH4, NO2 and NO3"
"0","    TIN = `NH4-N` + `NO2-N` + `NO3-N`,"
"0","    # Calculate [PO4]"
"0","    species_PO4_molL = calc_PO4(c_tot = `PO4-P`, pH = pH, form_P = ""PO4-P"", unit = ""mg""),"
"0","    # Calculate [CO3]"
"0","    species_CO3_molL = calc_CO3(pH = pH),"
"0","    # Calculate [OH]"
"0","    species_OH_molL = calc_OH(pH = pH),"
"0","    # Calculate [SO4]"
"0","    species_SO4_molL = calc_SO4(c_tot = `SO4-S`, pH = pH, form_S = ""SO4-S"", unit = ""mg"")"
"0","    ) %>% "
"0","  print()"
